<p><link rel='stylesheet' href='../assets/css/main.css'/></p>
<p><a href="../README.md">&lt;&lt; back to main index</a></p>
<h1 id="lab-1.3-simple-file-operations">Lab 1.3 : Simple File Operations</h1>
<h3 id="overview">Overview</h3>
<p>Write a Scala script, compile and run it</p>
<h3 id="depends-on">Depends On</h3>
<p>None</p>
<h3 id="run-time">Run time</h3>
<p>30 mins</p>
<h2 id="step-1-working-directory">Step 1 : Working Directory</h2>
<p>Please be in <code>01-scala</code> directory.</p>
<pre><code>    $    cd  ~/spark-labs/01-scala

    $    git pull   # update the labs</code></pre>
<h2 id="step-2-create-a-scala-program">Step 2 : Create a Scala Program</h2>
<p>Let’s create a file called <code>Dupe.scala</code>.<br />
We recommend that you use the sublime editor installed.<br />
You can always use <code>vi</code> or <code>nano</code> :-)</p>
<h4 id="vi-tip">VI Tip:</h4>
<p>If you copying code from another program into VI, you may notice that it is ‘indenting’ pasted code in correctly. One way to deal with this is</p>
<pre><code># within VI
Hit Esc key and type
:set paste   
and enter

Now you can paste the code easily</code></pre>
<h2 id="step-3-read-from-a-file-and-print-out-the-contents">Step 3 : Read From A File And Print Out The Contents</h2>
<p>Let’s read from file : <code>twinkle.txt</code></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode scala"><code class="sourceCode scala"><a class="sourceLine" id="cb3-1" data-line-number="1"></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw">import</span> scala.<span class="fu">io</span>.<span class="fu">Source</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="kw">object</span> Dupe {</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">    <span class="kw">def</span> <span class="fu">main</span>(args: Array[String]): Unit = {</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">        Source.<span class="fu">fromFile</span>(<span class="st">&quot;twinkle.txt&quot;</span>).<span class="fu">getLines</span>().<span class="fu">foreach</span> ( line =&gt; {</a>
<a class="sourceLine" id="cb3-7" data-line-number="7">        <span class="fu">println</span>(line)</a>
<a class="sourceLine" id="cb3-8" data-line-number="8">       })</a>
<a class="sourceLine" id="cb3-9" data-line-number="9">    }</a>
<a class="sourceLine" id="cb3-10" data-line-number="10">}</a></code></pre></div>
<h2 id="step-4-compile-and-run-the-program">Step 4 : Compile and Run The Program</h2>
<p>To compile:</p>
<pre><code>    $   scalac  Dupe.scala</code></pre>
<p>See generated files:</p>
<pre><code>    $   ls -l</code></pre>
<p>You will see a couple .class files generated by Scalac compiler.</p>
<p>To run</p>
<pre><code>    $   scala Dupe</code></pre>
<h2 id="step-5-optional-using-app-trait">Step 5 : [Optional] Using ‘App’ trait</h2>
<p>We can make our application extend <code>App</code> trait. Then we won’t need a main method. All statements within our object will be executed.</p>
<p>Try this: Create a file <code>DupeApp.scala</code> with the following content:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode scala"><code class="sourceCode scala"><a class="sourceLine" id="cb7-1" data-line-number="1"></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw">import</span> scala.<span class="fu">io</span>.<span class="fu">Source</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="kw">object</span> DupeApp <span class="kw">extends</span> App {</a>
<a class="sourceLine" id="cb7-5" data-line-number="5">    Source.<span class="fu">fromFile</span>(<span class="st">&quot;twinkle.txt&quot;</span>).<span class="fu">getLines</span>().<span class="fu">foreach</span> ( line =&gt; {</a>
<a class="sourceLine" id="cb7-6" data-line-number="6">    <span class="fu">println</span>(line)</a>
<a class="sourceLine" id="cb7-7" data-line-number="7">    })</a>
<a class="sourceLine" id="cb7-8" data-line-number="8">}</a></code></pre></div>
<p>To compile &amp; run:</p>
<pre><code>    $   scalac  DupeApp.scala
    $   scala DupeApp</code></pre>
<h2 id="step-6-detect-duplicate-lines">Step 6 : Detect Duplicate Lines</h2>
<p>In our ‘twinkle.txt’ there a few duplicates, line 5 &amp; 6.</p>
<pre><code>line 1 : twinkle twinkle little star
line 2 : how I wonder what you are
line 3 : up above the world so high
line 4 : like a diamond in the sky
line 5 : twinkle twinkle little star   &lt;--- DUPE
line 6 : how I wonder what you are   &lt;--- DUPE</code></pre>
<p>Our next step is print out the duplicates.</p>
<p>Hint : <code>Set.add</code> method will return <code>true</code> if an item is added, <code>false</code> if item is not added.</p>
<pre><code>    val added = set.add(line)</code></pre>
<p><strong>=&gt; Declare an empty ‘mutable’ Set of ‘String’ type</strong><br />
<strong>=&gt; Add each line, and check the return value and print out if duplicate</strong><br />
<strong>=&gt; Also print out line numbers</strong></p>
<p>Here is the code to get you started.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode scala"><code class="sourceCode scala"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw">import</span> scala.<span class="fu">io</span>.<span class="fu">Source</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="kw">object</span> Dupe {</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">    <span class="kw">def</span> <span class="fu">main</span>(args: Array[String]): Unit = {</a>
<a class="sourceLine" id="cb11-5" data-line-number="5"></a>
<a class="sourceLine" id="cb11-6" data-line-number="6">        <span class="co">// declare an *mutable* Set.  See slides for examples</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7">        <span class="kw">val</span> s = ??? Set[String] ()</a>
<a class="sourceLine" id="cb11-8" data-line-number="8"></a>
<a class="sourceLine" id="cb11-9" data-line-number="9">        Source.<span class="fu">fromFile</span>(<span class="st">&quot;twinkle.txt&quot;</span>).<span class="fu">getLines</span>().<span class="fu">foreach</span> ( line =&gt; {</a>
<a class="sourceLine" id="cb11-10" data-line-number="10">            <span class="fu">println</span>(line)</a>
<a class="sourceLine" id="cb11-11" data-line-number="11"></a>
<a class="sourceLine" id="cb11-12" data-line-number="12">            <span class="co">// try adding to set</span></a>
<a class="sourceLine" id="cb11-13" data-line-number="13">            <span class="kw">val</span> added = s.<span class="fu">add</span>(line)</a>
<a class="sourceLine" id="cb11-14" data-line-number="14">            <span class="kw">if</span> (added) {</a>
<a class="sourceLine" id="cb11-15" data-line-number="15">                <span class="co">// do some thing</span></a>
<a class="sourceLine" id="cb11-16" data-line-number="16">            }</a>
<a class="sourceLine" id="cb11-17" data-line-number="17">            <span class="kw">else</span> {</a>
<a class="sourceLine" id="cb11-18" data-line-number="18">                <span class="co">// do something else</span></a>
<a class="sourceLine" id="cb11-19" data-line-number="19">            }</a>
<a class="sourceLine" id="cb11-20" data-line-number="20">       })</a>
<a class="sourceLine" id="cb11-21" data-line-number="21">    }</a>
<a class="sourceLine" id="cb11-22" data-line-number="22">}</a></code></pre></div>
<h2 id="bonus-lab-1">Bonus Lab 1</h2>
<p>Modify the program to * not print each line * Just print ‘summary stats’ at the end of program run, like follows:<br />
‘total lines : 10, dupe lines : 5’</p>
<h2 id="bonus-lab-2">Bonus Lab 2</h2>
<p>Write out duplicate lines (only duplicate lines) into a file called ‘dupes.txt’</p>
