<p><link rel='stylesheet' href='../assets/css/main.css'/></p>
<p><a href="../README.md">&lt;&lt; back to main index</a></p>
<h1 id="lab-1.4-higher-order-functions">Lab 1.4 : Higher Order Functions</h1>
<h3 id="overview">Overview</h3>
<p>Write and use higher order functions.</p>
<h3 id="depends-on">Depends On</h3>
<p>None</p>
<h3 id="run-time">Run time</h3>
<p>20 mins</p>
<table>
<tbody>
<tr class="odd">
<td>Step 1 : Working Directory</td>
</tr>
</tbody>
</table>
<p>Please be in <code>01-scala</code> directory.</p>
<pre><code>    $    cd  ~/spark-labs/01-scala</code></pre>
<table style="width:38%;">
<colgroup>
<col style="width: 37%" />
</colgroup>
<thead>
<tr class="header">
<th>Step 2 : Create a Scala Class ‘MyTimer’</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Let’s create a file called <code>MyTimer.scala</code>.</td>
</tr>
</tbody>
</table>
<h2 id="step-3-add-a-timeit-function">Step 3 : Add a ‘timeit’ function</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode scala"><code class="sourceCode scala"><a class="sourceLine" id="cb2-1" data-line-number="1"></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw">object</span> MyTimer {</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">    <span class="kw">def</span> timeit[R](block: =&gt; R): R = {</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">        <span class="co">// look up &#39;java System class nano time&#39;</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5">        <span class="co">// http://docs.oracle.com/javase/8/docs/api/java/lang/System.html</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6">        <span class="kw">val</span> t1 = System.??? </a>
<a class="sourceLine" id="cb2-7" data-line-number="7">        <span class="kw">val</span> result = block    <span class="co">// call-by-name</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8">        <span class="kw">val</span> t2 = System.???</a>
<a class="sourceLine" id="cb2-9" data-line-number="9">        <span class="fu">println</span>(<span class="st">&quot;### timeit() : Elapsed time:  %,d  ms&quot;</span><span class="fu">.format</span>( (t2 - t1) /1000000 ) )</a>
<a class="sourceLine" id="cb2-10" data-line-number="10">        result</a>
<a class="sourceLine" id="cb2-11" data-line-number="11">    }</a>
<a class="sourceLine" id="cb2-12" data-line-number="12">}</a></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td>Step 4 : Create a Test Class</td>
</tr>
</tbody>
</table>
<p>Let’s create a file called <code>TestTimer.scala</code>.</p>
<p>Let’s measure the time taken for <code>sleepy</code> function.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode scala"><code class="sourceCode scala"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">import</span> MyTimer._</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="kw">object</span> TestTimer {</a>
<a class="sourceLine" id="cb3-4" data-line-number="4"></a>
<a class="sourceLine" id="cb3-5" data-line-number="5">    <span class="kw">def</span> <span class="fu">sleepy</span> (duration : Int) = {</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">        Thread.<span class="fu">sleep</span>(duration)</a>
<a class="sourceLine" id="cb3-7" data-line-number="7">        <span class="fu">println</span> (<span class="st">&quot;yawn... slept for &quot;</span> + duration)</a>
<a class="sourceLine" id="cb3-8" data-line-number="8">        duration</a>
<a class="sourceLine" id="cb3-9" data-line-number="9">    }</a>
<a class="sourceLine" id="cb3-10" data-line-number="10"></a>
<a class="sourceLine" id="cb3-11" data-line-number="11">    <span class="kw">def</span> <span class="fu">main</span>(args: Array[String]): Unit = {</a>
<a class="sourceLine" id="cb3-12" data-line-number="12">      <span class="kw">val</span> a = MyTimer.<span class="fu">timeit</span>(<span class="fu">sleepy</span>(<span class="dv">300</span>))</a>
<a class="sourceLine" id="cb3-13" data-line-number="13">      <span class="fu">println</span> (<span class="st">&quot;result 1 : &quot;</span> + a)</a>
<a class="sourceLine" id="cb3-14" data-line-number="14">    }</a>
<a class="sourceLine" id="cb3-15" data-line-number="15">}</a></code></pre></div>
<p>To compile:</p>
<pre><code>    $   scalac  MyTimer.scala TestTimer.scala</code></pre>
<p>See generated files:</p>
<pre><code>    $   ls -l</code></pre>
<p>You will see a few .class files generated by Scalac compiler.</p>
<p>To run</p>
<pre><code>    $   scala TestTimer</code></pre>
<table>
<tbody>
<tr class="odd">
<td>Step 5 : Quick Testing on Scala Shell</td>
</tr>
</tbody>
</table>
<p>Here is a handy way to test using Scala Shell…</p>
<p>Copy / Paste the Timer code into Scala Shell</p>
<pre><code>scala&gt;
    copy paste MyTimer.scala code here
    ...

    defined module MyTimer</code></pre>
<p>Now do testing:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode scala"><code class="sourceCode scala"><a class="sourceLine" id="cb8-1" data-line-number="1">scala&gt;</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">    MyTimer.<span class="fu">timeit</span> { <span class="dv">1</span> + <span class="dv">2</span>}</a></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td>Step 6 : Time The Following Operations</td>
</tr>
</tbody>
</table>
<p>You can test them in Scala shell or in ‘script’ mode.<br />
1 - For Scala shell see step above for tips.</p>
<p>2 - To test these in ‘script mode’ * Make changes to <code>TestTimer.scala</code> * Save the file and compile using</p>
<pre><code>    $   scalac  MyTimer.scala   TestTimer.scala</code></pre>
<ul>
<li>Run as</li>
</ul>
<pre><code>    $   scala  TestTimer</code></pre>
<p><strong>=&gt; How long for operation <code>1 + 2</code></strong><br />
Hint : You can invoke this as <code>timeit  { 1 + 2}</code>. () are not necessary.</p>
<p><strong>=&gt; How long does it take to calcuate squares of million numbers (1 to 1000000)</strong><br />
Hint : <code>timeit { ??? }</code></p>
